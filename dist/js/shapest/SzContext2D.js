export const rmode = true;
export const PI12 = -Math.PI / 12;
export class SzContext2D {
    static fromCanvas(cv) {
        let ctx = cv.getContext('2d');
        const PI = Math.PI;
        const PI12 = -PI / 12;
        ctx.scale(cv.width / 2, cv.height / 2);
        ctx.translate(1, 1);
        ctx.rotate(-Math.PI / 2);
        ctx.scale(1 / 1.15, 1 / 1.15);
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';
        return new SzContext2D(ctx);
    }
    clear() {
        this.ctx.clearRect(-2, -2, 4, 4);
    }
    ctx;
    constructor(ctx) {
        this.ctx = ctx;
    }
    get lineWidth() { return this.ctx.lineWidth; }
    set lineWidth(v) { this.ctx.lineWidth = v; }
    get strokeStyle() { return this.ctx.strokeStyle; }
    set strokeStyle(v) { this.ctx.strokeStyle = v; }
    get fillStyle() { return this.ctx.fillStyle; }
    set fillStyle(v) { this.ctx.fillStyle = v; }
    get globalAlpha() { return this.ctx.globalAlpha; }
    set globalAlpha(v) { this.ctx.globalAlpha = v; }
    beginPath() { this.ctx.beginPath(); }
    closePath() { this.ctx.closePath(); }
    stroke() { this.ctx.stroke(); }
    fill() { this.ctx.fill(); }
    clip() { this.ctx.clip(); }
    save() { this.ctx.save(); }
    restore() { this.ctx.restore(); }
    rotate(angle) {
        this.ctx.rotate(-angle * PI12);
        return this;
    }
    moveTo(x, y) {
        // log({ move: { x: +x.toFixed(3), y: +y.toFixed(3) } });
        this.ctx.moveTo(y, x);
        return this;
    }
    moveToR(r, a) {
        this.moveTo(-r * Math.sin(a * PI12), r * Math.cos(a * PI12));
        return this;
    }
    lineTo(x, y) {
        // log({ line: { x: +x.toFixed(3), y: +y.toFixed(3) } })
        this.ctx.lineTo(y, x);
        return this;
    }
    lineToR(radius, direction) {
        this.lineTo(-radius * Math.sin(direction * PI12), radius * Math.cos(direction * PI12));
        return this;
    }
    rToXY(radius, direction) {
        return [-radius * Math.sin(direction * PI12), radius * Math.cos(direction * PI12)];
    }
    arc(cx, cy, radius, from, to, dir) {
        this.ctx.arc(cx, cy, radius, -from * PI12, -to * PI12, dir);
        return this;
    }
    fillRect(x, y, w, h) {
        this.ctx.fillRect(x, y, w, h);
        return this;
    }
    saved(f) {
        this.save();
        f(this);
        this.restore();
    }
}
function log(...a) {
    console.error(...a);
    document.body.append(document.createElement('br'));
    for (let o of a)
        document.body.append(JSON.stringify(o));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3pDb250ZXh0MkQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvc2hhcGVzdC9TekNvbnRleHQyRC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxNQUFNLENBQUMsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDO0FBQzFCLE1BQU0sQ0FBQyxNQUFNLElBQUksR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLEdBQUcsRUFBRSxDQUFDO0FBT2xDLE1BQU0sT0FBTyxXQUFXO0lBQ3ZCLE1BQU0sQ0FBQyxVQUFVLENBQUMsRUFBcUI7UUFDdEMsSUFBSSxHQUFHLEdBQUcsRUFBRSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUUsQ0FBQztRQUMvQixNQUFNLEVBQUUsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDO1FBQ25CLE1BQU0sSUFBSSxHQUFHLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQztRQUN0QixHQUFHLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDdkMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDcEIsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDekIsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUcsSUFBSSxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQztRQUM5QixHQUFHLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztRQUN0QixHQUFHLENBQUMsUUFBUSxHQUFHLE9BQU8sQ0FBQztRQUN2QixPQUFPLElBQUksV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzdCLENBQUM7SUFDRCxLQUFLO1FBQ0osSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFD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QUFHLENBQUMsQ0FBQyxDQUFDO0lBQ3BCLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUNuRCxLQUFLLElBQUksQ0FBQyxJQUFJLENBQUM7UUFDZCxRQUFRLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDMUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5leHBvcnQgY29uc3Qgcm1vZGUgPSB0cnVlO1xyXG5leHBvcnQgY29uc3QgUEkxMiA9IC1NYXRoLlBJIC8gMTI7XHJcblxyXG5leHBvcnQgdHlwZSByb3RhdGlvbjI0ID0gbnVtYmVyICYgeyBfPzogcm90YXRpb24yNCB9XHJcbmV4cG9ydCB0eXBlIGNoYXIgPSBzdHJpbmcgJiB7IF8/OiBjaGFyIH07XHJcbmV4cG9ydCB0eXBlIHN0eWxlU3RyaW5nID0gc3RyaW5nICYgeyBfPzogc3R5bGVTdHJpbmcgfTtcclxuXHJcblxyXG5leHBvcnQgY2xhc3MgU3pDb250ZXh0MkQge1xyXG5cdHN0YXRpYyBmcm9tQ2FudmFzKGN2OiBIVE1MQ2FudmFzRWxlbWVudCkge1xyXG5cdFx0bGV0IGN0eCA9IGN2LmdldENvbnRleHQoJzJkJykhO1xyXG5cdFx0Y29uc3QgUEkgPSBNYXRoLlBJO1xyXG5cdFx0Y29uc3QgUEkxMiA9IC1QSSAvIDEyO1xyXG5cdFx0Y3R4LnNjYWxlKGN2LndpZHRoIC8gMiwgY3YuaGVpZ2h0IC8gMik7XHJcblx0XHRjdHgudHJhbnNsYXRlKDEsIDEpO1xyXG5cdFx0Y3R4LnJvdGF0ZSgtTWF0aC5QSSAvIDIpO1xyXG5cdFx0Y3R4LnNjYWxlKDEgLyAxLjE1LCAxIC8gMS4xNSk7XHJcblx0XHRjdHgubGluZUNhcCA9ICdyb3VuZCc7XHJcblx0XHRjdHgubGluZUpvaW4gPSAncm91bmQnO1xyXG5cdFx0cmV0dXJuIG5ldyBTekNvbnRleHQyRChjdHgpO1xyXG5cdH1cclxuXHRjbGVhcigpIHtcclxuXHRcdHRoaXMuY3R4LmNsZWFyUmVjdCgtMiwgLTIsIDQsIDQpO1xyXG5cdH1cclxuXHJcblx0Y3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQ7XHJcblxyXG5cdGNvbnN0cnVjdG9yKGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEKSB7XHJcblx0XHR0aGlzLmN0eCA9IGN0eDtcclxuXHR9XHJcblx0Z2V0IGxpbmVXaWR0aCgpIHsgcmV0dXJuIHRoaXMuY3R4LmxpbmVXaWR0aDsgfVxyXG5cdHNldCBsaW5lV2lkdGgodikgeyB0aGlzLmN0eC5saW5lV2lkdGggPSB2OyB9XHJcblx0Z2V0IHN0cm9rZVN0eWxlKCkgeyByZXR1cm4gdGhpcy5jdHguc3Ryb2tlU3R5bGUgYXMgc3R5bGVTdHJpbmc7IH1cclxuXHRzZXQgc3Ryb2tlU3R5bGUodikgeyB0aGlzLmN0eC5zdHJva2VTdHlsZSA9IHY7IH1cclxuXHRnZXQgZmlsbFN0eWxlKCkgeyByZXR1cm4gdGhpcy5jdHguZmlsbFN0eWxlIGFzIHN0eWxlU3RyaW5nOyB9XHJcblx0c2V0IGZpbGxTdHlsZSh2KSB7IHRoaXMuY3R4LmZpbGxTdHlsZSA9IHY7IH1cclxuXHRnZXQgZ2xvYmFsQWxwaGEoKSB7IHJldHVybiB0aGlzLmN0eC5nbG9iYWxBbHBoYTsgfVxyXG5cdHNldCBnbG9iYWxBbHBoYSh2KSB7IHRoaXMuY3R4Lmdsb2JhbEFscGhhID0gdjsgfVxyXG5cclxuXHJcblx0YmVnaW5QYXRoKCkgeyB0aGlzLmN0eC5iZWdpblBhdGgoKTsgfVxyXG5cdGNsb3NlUGF0aCgpIHsgdGhpcy5jdHguY2xvc2VQYXRoKCk7IH1cclxuXHRzdHJva2UoKSB7IHRoaXMuY3R4LnN0cm9rZSgpOyB9XHJcblx0ZmlsbCgpIHsgdGhpcy5jdHguZmlsbCgpOyB9XHJcblx0Y2xpcCgpIHsgdGhpcy5jdHguY2xpcCgpOyB9XHJcblx0c2F2ZSgpIHsgdGhpcy5jdHguc2F2ZSgpOyB9XHJcblx0cmVzdG9yZSgpIHsgdGhpcy5jdHgucmVzdG9yZSgpOyB9XHJcblxyXG5cdHJvdGF0ZShhbmdsZTogcm90YXRpb24yNCkge1xyXG5cdFx0dGhpcy5jdHgucm90YXRlKC1hbmdsZSAqIFBJMTIpO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fVxyXG5cdG1vdmVUbyh4OiBudW1iZXIsIHk6IG51bWJlcikge1xyXG5cdFx0Ly8gbG9nKHsgbW92ZTogeyB4OiAreC50b0ZpeGVkKDMpLCB5OiAreS50b0ZpeGVkKDMpIH0gfSk7XHJcblx0XHR0aGlzLmN0eC5tb3ZlVG8oeSwgeCk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9XHJcblx0bW92ZVRvUihyOiBudW1iZXIsIGE6IHJvdGF0aW9uMjQpIHtcclxuXHRcdHRoaXMubW92ZVRvKC1yICogTWF0aC5zaW4oYSAqIFBJMTIpLCByICogTWF0aC5jb3MoYSAqIFBJMTIpKTtcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH1cclxuXHRsaW5lVG8oeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcclxuXHRcdC8vIGxvZyh7IGxpbmU6IHsgeDogK3gudG9GaXhlZCgzKSwgeTogK3kudG9GaXhlZCgzKSB9IH0pXHJcblx0XHR0aGlzLmN0eC5saW5lVG8oeSwgeCk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9XHJcblx0bGluZVRvUihyYWRpdXM6IG51bWJlciwgZGlyZWN0aW9uOiByb3RhdGlvbjI0KSB7XHJcblx0XHR0aGlzLmxpbmVUbygtcmFkaXVzICogTWF0aC5zaW4oZGlyZWN0aW9uICogUEkxMiksIHJhZGl1cyAqIE1hdGguY29zKGRpcmVjdGlvbiAqIFBJMTIpKTtcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH1cclxuXHRyVG9YWShyYWRpdXM6IG51bWJlciwgZGlyZWN0aW9uOiByb3RhdGlvbjI0KSB7XHJcblx0XHRyZXR1cm4gWy1yYWRpdXMgKiBNYXRoLnNpbihkaXJlY3Rpb24gKiBQSTEyKSwgcmFkaXVzICogTWF0aC5jb3MoZGlyZWN0aW9uICogUEkxMildIGFzIGNvbnN0O1xyXG5cdH1cclxuXHRhcmMoXHJcblx0XHRjeDogbnVtYmVyLCBjeTogbnVtYmVyLCByYWRpdXM6IG51bWJlciwgZnJvbTogcm90YXRpb24yNCwgdG86IHJvdGF0aW9uMjQsIGRpcj86IGJvb2xlYW5cclxuXHQpIHtcclxuXHRcdHRoaXMuY3R4LmFyYyhjeCwgY3ksIHJhZGl1cywgLWZyb20gKiBQSTEyLCAtdG8gKiBQSTEyLCBkaXIpO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fVxyXG5cdGZpbGxSZWN0KHg6IG51bWJlciwgeTogbnVtYmVyLCB3OiBudW1iZXIsIGg6IG51bWJlcikge1xyXG5cdFx0dGhpcy5jdHguZmlsbFJlY3QoeCwgeSwgdywgaCk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9XHJcblxyXG5cdHNhdmVkKGY6IChjdHg6IHRoaXMpID0+IHZvaWQpIHtcclxuXHRcdHRoaXMuc2F2ZSgpO1xyXG5cdFx0Zih0aGlzKTtcclxuXHRcdHRoaXMucmVzdG9yZSgpO1xyXG5cdH1cclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIGxvZyguLi5hOiBhbnlbXSkge1xyXG5cdGNvbnNvbGUuZXJyb3IoLi4uYSk7XHJcblx0ZG9jdW1lbnQuYm9keS5hcHBlbmQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnInKSk7XHJcblx0Zm9yIChsZXQgbyBvZiBhKVxyXG5cdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmQoSlNPTi5zdHJpbmdpZnkobykpO1xyXG59XHJcbiJdfQ==